-- Create a view that flattens the metadata structure.
-- TODO generate this in gen_ddl.py from the schema def.
create or replace view raw_base_metadata
as
SELECT 
    observation_uuid:uuid,
    filetype,
    metadata.aoutMachineType,
    metadata.coffMachineType,
    metadata.whateverdockerthing,
    metadata.OS,
    metadata.EI_CLASS,
    metadata.EI_DATA,
    metadata.EI_VERSION,
    metadata.EI_OSABI,
    metadata.EI_ABIVERSION,
    metadata.E_MACHINE,
    metadata.elfDependencies,
    metadata.elfRpath,
    metadata.elfRunpath,
    metadata.elfSoname,
    metadata.elfInterpreter,
    metadata.elfDynamicFlags,
    metadata.elfDynamicFlags1,
    metadata.elfGnuRelro,
    metadata.elfComment,
    metadata.elfNote,
    metadata.elfOsAbi,
    metadata.elfHumanArch,
    metadata.elfArchNumber,
    metadata.elfArchitecture,
    metadata.elfIsExe,
    metadata.elfIsLib,
    metadata.elfIsRel,
    metadata.elfIsCore,
    metadata.whateverjsthing,
    metadata.numBinaries,
    metadata.binaries,
    metadata.whatevernativething,
    metadata.whateverolething,
    metadata.peMachine,
    metadata.peOperatingSystemVersion,
    metadata.peSubsystemVersion,
    metadata.peSubsystem,
    metadata.peLinkerVersion,
    metadata.peImport,
    metadata.peIsExe,
    metadata.peIsDll,
    metadata.peIsClr,
    metadata.FileInfo,
    metadata.dllRedirectionLocal,
    metadata.whateverrpmthing,
    metadata.whateveruimagething,
    metadata.description
FROM raw_json
;