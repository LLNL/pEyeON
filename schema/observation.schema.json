{
  "$id": "observation.schema.json",
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "EyeON Observation",
  "type": "object",
  "required": ["bytecount", "filename", "magic", "md5", "observation_ts", "sha1", "sha256"],
  "properties": {
    "bytecount": {
      "type":"integer",
      "description": "Size of file in bytes"
    },
    "compiler": {
      "type": "string",
      "description": "Compiler Identifier"
    },
    "filename": {
      "type": "string",
      "description": "Basename of file"
    },
    "hosts": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "List of hosts file will target"
    },
    "imphash": {
      "type": "string",
      "description": "Import Hash calculated via pefile"
    },
    "magic": {
      "type": "string",
      "description": "`file` Magic output for given file"
    },
    "md5": {
      "type": "string",
      "description": "MD5 of file"
    },
    "observation_ts": {
      "type": "string",
      "description": "Date and time file was scanned"
    },
    "parent": {
      "type": "string",
      "description": "Some yet-to-be-determined pointer to a parent file or something"
    },
    "sha1": {
      "type": "string",
      "description": "Sha1 of file"
    },
    "sha256": {
      "type": "string",
      "description": "Sha256 of file"
    },
    "target_os": {
      "type": "string",
      "description": "Operating system of target machine"
    },
    "config": {
      "type": "object",
      "additionalProperties": true,
      "description": "List of attributes from the configuration file"
    },
    "signatures": {
      "type": "object",
      "additionalProperties": false,
      "description": "Metadata of each signature", 
      "properties": {
        "valid": {
          "type": "string"
        },
        "signatures": {
          "e2f1f0c4b4b6524e1054bd5980129996bc021daa": {
            "type": "object",
            "properties": {
              "certs": {
                "type": "object",
                "properties": {
                  "7db9f7402a523dd338663b33d55aad0dd08cb67e687df0d4d98e7c5fca27efd1": {
                    "type": "object",
                    "properties": {
                      "cert._version": { "type": "string" },
                      "serial_number": { "type": "string" },
                      "issuer_name": { "type": "string" },
                      "subject_name": { "type": "string" },
                      "issued_on": { "type": "string"},
                      "expires_on": { "type": "string"},
                      "signed_using": { "type": "string" },
                      "RSA_key_size": { "type": "string" },
                      "basic_constraints": { "type": "string" },
                      "key_usage": { "type": "string" },
                      "ext_key_usage": { "type": "string" },
                      "certificate_policies": { "type": "string" }
                    },
                    "required": ["cert._version", "serial_number", "issuer_name", "subject_name", "issued_on", "expires_on", "signed_using", "RSA_key_size", "basic_constraints", "key_usage", "ext_key_usage", "certificate_policies"]
                  },
                  "33846b545a49c9be4903c60e01713c1bd4e4ef31ea65cd95d69e62794f30b941": {
                    "type": "object"
                  },
                  "1e685913aa6c2199c5bb14fcee38c6416a18e36cc2b38c85b97152c7ee70430b": {
                    "type": "object"
                  },
                  "7fb0f58d71130abe724969f1cdc9b6a8d3274da18d059229b009a5b9b5557445": {
                    "type": "object"
                  },
                  "281734d4592d1291d27190709cb510b07e22c405d5e0d6119b70e73589f98acf": {
                    "type": "object"
                  },
                  "c7f4e1be32288920abe2263abe1ac4fc4fe6781c2d64d04c807557a023b5b6fa": {
                    "type": "object"
                  }
                }
              },
              "signers": "string",
              "digest_algorithm": "string",
              "verification": "string"
            }
          }
        }
      }
    }
  }
}
